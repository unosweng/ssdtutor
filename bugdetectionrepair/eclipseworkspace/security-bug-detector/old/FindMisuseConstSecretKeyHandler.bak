package handlers;

import java.util.HashSet;

import org.eclipse.e4.core.di.annotations.Execute;
import org.eclipse.e4.ui.workbench.modeling.EPartService;

import analysis.ExecuteAnalysis;
import input.IRuleInfo;
import visitor.FindMisuseConstSecretKeyDetector;

public class FindMisuseConstSecretKeyHandler {
   boolean clear = true;
   int detectionCount = 0;
   HashSet<String> treeList;
   
   public int getDetectionCount() {
      return detectionCount;
   }

   public void execute(EPartService epartService, boolean clear) {
      this.clear = clear;
      this.execute(epartService);
   }

   @Execute
   public void execute(EPartService epartService) {
      FindMisuseConstSecretKeyDetector detector = new FindMisuseConstSecretKeyDetector();
      ExecuteAnalysis ea = new ExecuteAnalysis(detector, 3, IRuleInfo.SKS_MSG);
      detectionCount = ea.go(epartService, this.clear);
      treeList = ea.getTreeList();
   }
}