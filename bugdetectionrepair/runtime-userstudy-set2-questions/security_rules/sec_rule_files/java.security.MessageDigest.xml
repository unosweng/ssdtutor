<?xml version="1.0" encoding="UTF-8"?>
<rules id="r-java-message-digest" class="java.security.MessageDigest">
    <rule method="getInstance">
        <argument index="1" name="algorithm" searchType="equals">
            <value string="MD2" security="weak"/>
            <value string="MD5" security="weak"/>
            <value string="SHA-1" security="weak"/>
            <value string="SHA-224" security="weak"/>
            <value string="SHA1" security="weak"/>
            <value string="sha1" security="weak"/>
            <value string="SHA" security="weak"/>
            <value string="GOST3411" security="weak"/>
            <value string="SHA-256" security="strong"/>
            <value string="SHA-384" security="strong"/>
            <value string="SHA-512" security="strong"/>
            <value string="SHA256" security="strong"/>
            <value string="SHA384" security="strong"/>
            <value string="SHA3-512" security="strong"/>
            <value string="SHA512" security="strong"/>
            <value string="\bSHA.*\b" security="strong"/>
        </argument>
        <argument index="2" name="provider">
            <value string="(.*?)" />
            <value reference="r1-javax-provider" />
        </argument>	
    </rule>
    <rule method="update">
        <argument index="1" name="getBytes">
            <value string="(.*?)" />
        </argument>
        <argument index="2" name="offset">
            <value int=".*\d.*" />
        </argument>
        <argument index="3" name="len">
            <value int=".*\d.*" />
        </argument>
    </rule>
    <rule method="digest">
        <noarguments></noarguments>
        <argument index="1" name="getBytes" searchType="equals">
            <value string="(.*?)" security="weak"/>
            <value reference="r-javax-secureRandom" security="strong"/>
        </argument>
        <argument index="2" name="offset">
            <value int=".*\d.*" />
        </argument>
        <argument index="3" name="length">
            <value int=".*\d.*" />
        </argument>
    </rule>
</rules>
